{"version":3,"sources":["../../../src/controllers/workTimeTableController.js"],"names":["WorkTime","require","workTimeTableController","nav","getTimeTablePage","req","res","console","log","user","username","render","title","userName","message","getTimeTableMenu","createTimeTable","item","body","workStart","workEnd","newWorkTimeItem","createSchedule","save","err","errMsg","updateTimeTable","findOneAndUpdate","id","start","end","workTimeItem","error","deleteTimeTable","findOneAndRemove","data","memberName","getEvents","query","find","startTime","endTime","$and","$gte","$lte","exec","workTimeItems","send","checkIfSignIn","module","exports"],"mappings":"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","file":"workTimeTableController.js","sourcesContent":["var WorkTime = require('../models/workTimeTableModel');\n\nvar workTimeTableController = function (nav) {\n\n    var getTimeTablePage = function (req, res) {\n\n        console.log(`UserName: ${req.user.username}`);\n        res.render('workTimeTable',\n            {\n                title: 'Work Time Table',\n                userName: req.user.username,\n                nav: nav,\n                message: ''\n            })\n    };\n\n    var getTimeTableMenu = function (req, res) {\n\n        res.render('timeTableMenu',\n            {\n                title: 'Time Table Menu',\n                userName: req.user.username,\n                nav: nav,\n                message: ''\n            })\n    };\n\n    var createTimeTable = function (req, res) {\n        var item = req.body;\n            console.log(`memberName: ${req.body.user}`);\n            console.log(`title: ${item.title}`);\n            console.log(`start: ${item.workStart}`);\n            console.log(`end: ${item.workEnd}`);\n\n            var newWorkTimeItem = createSchedule(item);\n            newWorkTimeItem.save(function (err) {\n                if(err) {\n                    var errMsg = `Sorry there were an erorr saving the stand-up hour time. + ${err}`;\n                    res.render('workTimeTable',\n                        {\n                            title: 'Work Time Table',\n                            userName: req.user.username,\n                            nav: nav,\n                            message: errMsg\n                        })\n                }\n            });\n    };\n\n\n    var updateTimeTable = function (req, res) {\n        WorkTime.findOneAndUpdate({id: req.body.id }, { start: req.body.workStart, end: req.body.workEnd }, function (err, workTimeItem) {\n            if(err) console.error(`Err: ${err}`);\n            console.log(`Event ${req.body.title} updated successfully`);\n        })\n    };\n\n    var deleteTimeTable = function (req, res) {\n        console.log(`ID: ${req.body.id}`);\n        WorkTime.findOneAndRemove({id: req.body.id }, function (err) {\n            if(err) console.error(`Err: ${err}`);\n            console.log(`Event delete successfully`);\n        })\n    };\n\n    function createSchedule(data) {\n        return new WorkTime({\n            id: data.id,\n            memberName: data.user,\n            title: data.title,\n            start: data.workStart,\n            end: data.workEnd\n        });\n    };\n\n    var getEvents = function(req, res) {\n        var query = WorkTime.find();\n        var startTime = req.query.start;\n        var endTime = req.query.end;\n        query.find({$and: [{memberName: req.user.username ,start: {$gte: startTime}, end: {$lte: endTime}}]})\n            .exec(function (err, workTimeItems) {\n                if(err) {\n                    console.error(`Error: ${err}`);\n                }\n                console.log(`Results: ${workTimeItems}`);\n                res.send(workTimeItems);\n            });\n    };\n\n    return {\n        getTimeTablePage: getTimeTablePage,\n        getTimeTableMenu: getTimeTableMenu,\n        createTimeTable: createTimeTable,\n        updateTimeTable: updateTimeTable,\n        deleteTimeTable: deleteTimeTable,\n        checkIfSignIn: checkIfSignIn,\n        getEvents: getEvents\n    }\n};\n\nmodule.exports = workTimeTableController;"]}